

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>6.6. Natural Language Processing &#8212; Effective Python for Data Scientists</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=c5ced968eda925caa686" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=c5ced968eda925caa686" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=c5ced968eda925caa686" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=c5ced968eda925caa686" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=c5ced968eda925caa686" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=c5ced968eda925caa686" />
  <script src="../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=c5ced968eda925caa686"></script>

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script kind="utterances">

    var commentsRunWhenDOMLoaded = cb => {
    if (document.readyState != 'loading') {
        cb()
    } else if (document.addEventListener) {
        document.addEventListener('DOMContentLoaded', cb)
    } else {
        document.attachEvent('onreadystatechange', function() {
        if (document.readyState == 'complete') cb()
        })
    }
}

var addUtterances = () => {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src = "https://utteranc.es/client.js";
    script.async = "async";

    script.setAttribute("repo", "khuyentran1401/Efficient_Python_tricks_and_tools_for_data_scientists");
    script.setAttribute("issue-term", "pathname");
    script.setAttribute("theme", "github-light");
    script.setAttribute("label", "üí¨ comment");
    script.setAttribute("crossorigin", "anonymous");

    sections = document.querySelectorAll("div.section");
    if (sections !== null) {
        section = sections[sections.length-1];
        section.appendChild(script);
    }
}
commentsRunWhenDOMLoaded(addUtterances);
</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Chapter5/natural_language_processing';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="6.7. Time Series" href="time_series.html" />
    <link rel="prev" title="6.5. Machine Learning" href="machine_learning.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../README.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/data_simplified_icon.png" class="logo__image only-light" alt="Effective Python for Data Scientists - Home"/>
    <script>document.write(`<img src="../_static/data_simplified_icon.png" class="logo__image only-dark" alt="Effective Python for Data Scientists - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../README.html">
                    What Should You Expect From This Book?
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../how_to_read.html">1. How to Read This Book</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Chapter1/Chapter1.html">2. Python Built-in Methods</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Chapter1/string.html">2.1. String</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter1/number.html">2.2. Number</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Chapter1/list/list.html">2.3. List</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../Chapter1/list/get_elements.html">2.3.1. Get Elements</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Chapter1/list/unpack_iterables.html">2.3.2. Unpack Iterables</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Chapter1/list/join_iterable.html">2.3.3. Join Iterables</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Chapter1/list/apply_functions_to_elements.html">2.3.4. Apply Functions to Elements in a List</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter1/set.html">2.4. Set</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter1/dictionary.html">2.5. Dictionary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter1/function.html">2.6. Function</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter1/class.html">2.7. Classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter1/datetime.html">2.8. Datetime</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter1/code_speed.html">2.9. Code Speed</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter1/good_practices.html">2.10. Good Python Practices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter1/python_new_features.html">2.11. New Features in Python</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Chapter2/Chapter2.html">3. Python Utility Libraries</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Chapter2/collections.html">3.1. Collections</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter2/itertools.html">3.2. Itertools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter2/functools.html">3.3. Functools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter2/pydash.html">3.4. Pydash</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter2/sympy.html">3.5. SymPy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter2/operator.html">3.6. Operator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter2/dataclasses.html">3.7. Data Classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter2/typing.html">3.8. Typing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter2/pathlib.html">3.9. pathlib</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter2/pydantic.html">3.10. Pydantic</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Chapter3/Chapter3.html">4. Pandas</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Chapter3/change_values.html">4.1. Change Values</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter3/get_values.html">4.2. Get Certain Values From a DataFrame</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter3/date_time.html">4.3. Work with Datetime</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter3/transform_dataframe.html">4.4. Transform a DataFrame</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter3/create_dataframe.html">4.5. Create a DataFrame</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter3/combine_dataframes.html">4.6. Combine Multiple DataFrames</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter3/filter.html">4.7. Filter Rows or Columns</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter3/data_types.html">4.8. Manipulate a DataFrame Using Data Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter3/sort_dataframe.html">4.9. Sort Rows or Columns of a DataFrame</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter3/string.html">4.10. Work with String</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter3/style_dataframe.html">4.11. Style a DataFrame</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter3/testing.html">4.12. Test</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Chapter4/Chapter4.html">5. NumPy</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Chapter4/Numpy.html">5.1. NumPy</a></li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="Chapter5.html">6. Data Science Tools</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="feature_extraction.html">6.1. Feature Extraction</a></li>
<li class="toctree-l2"><a class="reference internal" href="feature_engineer.html">6.2. Feature Engineer</a></li>
<li class="toctree-l2"><a class="reference internal" href="get_data.html">6.3. Get Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="manage_data.html">6.4. Manage Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="machine_learning.html">6.5. Machine Learning</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">6.6. Natural Language Processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="time_series.html">6.7. Time Series</a></li>
<li class="toctree-l2"><a class="reference internal" href="sharing_downloading.html">6.8. Sharing and Downloading</a></li>
<li class="toctree-l2"><a class="reference internal" href="speed_up_code.html">6.9. Tools to Speed Up Code</a></li>
<li class="toctree-l2"><a class="reference internal" href="visualization.html">6.10. Visualization</a></li>
<li class="toctree-l2"><a class="reference internal" href="better_pandas.html">6.11. Better Pandas</a></li>
<li class="toctree-l2"><a class="reference internal" href="testing.html">6.12. Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="SQL.html">6.13. SQL Libraries</a></li>
<li class="toctree-l2"><a class="reference internal" href="polars.html">6.14. Polars</a></li>
<li class="toctree-l2"><a class="reference internal" href="spark.html">6.15. PySpark</a></li>
<li class="toctree-l2"><a class="reference internal" href="deltalake.html">6.16. Delta Lake</a></li>
<li class="toctree-l2"><a class="reference internal" href="llm.html">6.17. Large Language Model (LLM)</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Chapter6/Chapter6.html">7. Cool Tools</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Chapter6/best_python_practice_tools.html">7.1. Tools for Best Python Practices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter6/alternative_approach.html">7.2. Alternative Approach</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter6/workflow_automation.html">7.3. Workflow Automation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter6/code_review.html">7.4. Code Review</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter6/logging_debugging.html">7.5. Logging and Debugging</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter6/better_outputs.html">7.6. Better Outputs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter6/git_github.html">7.7. Git and GitHub</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter6/env_management.html">7.8. Environment Management</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Chapter7/Chapter7.html">8. Jupyter Notebook</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Chapter7/jupyter_notebook.html">8.1. Jupyter Notebook</a></li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/khuyentran1401/Efficient_Python_tricks_and_tools_for_data_scientists/blob/master/./Chapter5/natural_language_processing.md" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/khuyentran1401/Efficient_Python_tricks_and_tools_for_data_scientists" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/khuyentran1401/Efficient_Python_tricks_and_tools_for_data_scientists/issues/new?title=Issue%20on%20page%20%2FChapter5/natural_language_processing.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/Chapter5/natural_language_processing.ipynb" target="_blank"
   class="btn btn-sm btn-download-notebook-button dropdown-item"
   title="Download notebook file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-code"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li><a href="../_sources/Chapter5/natural_language_processing.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Natural Language Processing</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#textblob-processing-text-in-one-line-of-code">6.6.1. TextBlob: Processing Text in One Line of Code</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#convert-names-into-a-generalized-format">6.6.2. Convert Names into a Generalized Format</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sumy-summarize-text-in-one-line-of-code">6.6.3. sumy: Summarize Text in One Line of Code</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spacy-streamlit-create-a-web-app-to-visualize-your-text-in-3-lines-of-code">6.6.4. Spacy_streamlit: Create a Web App to Visualize Your Text in 3 Lines of Code</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#textacy-extract-a-contiguous-sequence-of-words">6.6.5. textacy: Extract a Contiguous Sequence of Words</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#num2words-convert-number-to-words">6.6.6. Num2Words: Convert Number to Words</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#numerizer-standardizing-numerical-data-in-text">6.6.7. Numerizer: Standardizing Numerical Data in Text</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#preprocess-text-in-one-line-of-code-with-texthero">6.6.8. Preprocess Text in One Line of Code with Texthero</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#texthero-reduce-dimension-and-visualize-text-in-one-line-of-code">6.6.9. texthero: Reduce Dimension and Visualize Text in One Line of Code</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#wordfreq-estimate-the-frequency-of-a-word-in-36-languages">6.6.10. wordfreq: Estimate the Frequency of a Word in 36 Languages</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#newspaper3k-extract-meaningful-information-from-an-articles-in-2-lines-of-code">6.6.11. newspaper3k: Extract Meaningful Information From an Articles in 2 Lines of Code</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#questgen-ai-question-generator-in-python">6.6.12. Questgen.ai: Question Generator in Python</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#word-ninja-slice-your-lumped-together-words">6.6.13. Word Ninja: Slice Your Lumped-Together Words</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#textstat-calculate-statistics-from-text">6.6.14. textstat: Calculate Statistics From Text</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rapidfuzz-rapid-string-matching-in-python">6.6.15. RapidFuzz: Rapid String Matching in Python</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#checklist-create-data-to-test-your-nlp-model">6.6.16. Checklist: Create Data to Test Your NLP Model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#top2vec-quick-topic-modeling-in-python">6.6.17. Top2Vec: Quick Topic Modeling in Python</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#expanding-english-contractions-in-text">6.6.18. Expanding English Contractions in Text</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#inflect-generate-plurals-singulars-and-indefinite-articles">6.6.19. inflect: Generate Plurals, Singulars, and Indefinite Articles</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ekphrasis-text-processing-tool-for-social-media-text">6.6.20. ekphrasis: Text Processing Tool For Social Media Text</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#chroma-the-lightning-fast-solution-to-text-embeddings-and-querying">6.6.21. Chroma: The Lightning-Fast Solution to Text Embeddings and Querying</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#galatic-clean-and-analyze-massive-text-datasets">6.6.22. Galatic: Clean and Analyze Massive Text Datasets</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#efficient-keyword-extraction-and-replacement-with-flashtext">6.6.23. Efficient Keyword Extraction and Replacement with FlashText</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bertopic-harnessing-bert-for-interpretable-topic-modeling">6.6.24. BERTopic: Harnessing BERT for Interpretable Topic Modeling</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#berttopic-enhance-topic-models-with-expert-defined-themes">6.6.25. BertTopic: Enhance Topic Models with Expert-Defined Themes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bertviz-visualize-nlp-model-attention-patterns">6.6.26. BertViz: Visualize NLP Model Attention Patterns</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#beyond-keywords-building-a-semantic-recipe-search-engine">6.6.27. Beyond Keywords: Building a Semantic Recipe Search Engine</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#skillner-automating-skill-extraction-in-python">6.6.28. SkillNER: Automating Skill Extraction in Python</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#nlpaug-enhancing-nlp-model-performance-with-data-augmentation">6.6.29. nlpaug: Enhancing NLP Model Performance with Data Augmentation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#gliner-the-lightweight-alternative-to-llms-for-custom-ner">6.6.30. GLiNER: The Lightweight Alternative to LLMs for Custom NER</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="natural-language-processing">
<h1><span class="section-number">6.6. </span>Natural Language Processing<a class="headerlink" href="#natural-language-processing" title="Permalink to this heading">#</a></h1>
<p>This section some tools to process and work with text.</p>
<section id="textblob-processing-text-in-one-line-of-code">
<h2><span class="section-number">6.6.1. </span>TextBlob: Processing Text in One Line of Code<a class="headerlink" href="#textblob-processing-text-in-one-line-of-code" title="Permalink to this heading">#</a></h2>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>!pip install textblob
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>!python -m textblob.download_corpora
</pre></div>
</div>
</div>
</details>
</div>
<p>TextBlob offers quick text analysis, such as sentiment detection, tokenization, noun phrase extraction, word frequency analysis, and spelling correction. Start by creating a <code class="docutils literal notranslate"><span class="pre">TextBlob</span></code> instance:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">textblob</span> <span class="kn">import</span> <span class="n">TextBlob</span>

<span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;Today is a beautiful day&quot;</span>
<span class="n">blob</span> <span class="o">=</span> <span class="n">TextBlob</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Tokenize words:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">blob</span><span class="o">.</span><span class="n">words</span>
</pre></div>
</div>
</div>
</div>
<p>Extract noun phrases:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">blob</span><span class="o">.</span><span class="n">noun_phrases</span>
</pre></div>
</div>
</div>
</div>
<p>Analyze sentiment:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">blob</span><span class="o">.</span><span class="n">sentiment</span>
</pre></div>
</div>
</div>
</div>
<p>Count words:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">blob</span><span class="o">.</span><span class="n">word_counts</span>
</pre></div>
</div>
</div>
</div>
<p>Correct spelling:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;Today is a beutiful day&quot;</span>
<span class="n">blob</span> <span class="o">=</span> <span class="n">TextBlob</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
<span class="n">blob</span><span class="o">.</span><span class="n">correct</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p><a class="reference external" href="https://github.com/sloria/TextBlob">Link to TextBlob</a>.</p>
</section>
<section id="convert-names-into-a-generalized-format">
<h2><span class="section-number">6.6.2. </span>Convert Names into a Generalized Format<a class="headerlink" href="#convert-names-into-a-generalized-format" title="Permalink to this heading">#</a></h2>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>!pip install mlxtend
</pre></div>
</div>
</div>
</details>
</div>
<p>Names collected from different sources might have different formats. To convert names into the same format for further processing, use mlxtend‚Äôs <code class="docutils literal notranslate"><span class="pre">generalize_names</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mlxtend.text</span> <span class="kn">import</span> <span class="n">generalize_names</span>

<span class="n">generalize_names</span><span class="p">(</span><span class="s2">&quot;Tran, Khuyen&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">generalize_names</span><span class="p">(</span><span class="s2">&quot;Khuyen Tran&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">generalize_names</span><span class="p">(</span><span class="s2">&quot;Khuyen Tran&quot;</span><span class="p">,</span> <span class="n">firstname_output_letters</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><a class="reference external" href="https://rasbt.github.io/mlxtend/">Link to mlxtend</a>.</p>
</section>
<section id="sumy-summarize-text-in-one-line-of-code">
<h2><span class="section-number">6.6.3. </span>sumy: Summarize Text in One Line of Code<a class="headerlink" href="#sumy-summarize-text-in-one-line-of-code" title="Permalink to this heading">#</a></h2>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>!pip install sumy
</pre></div>
</div>
</div>
</details>
</div>
<p>Sumy is an easy-to-use tool for text summarization, offering 7 different methods. To summarize the article ‚ÄúHow to Learn Data Science (Step-By-Step)‚Äù from DataQuest:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>sumy<span class="w"> </span>lex-rank<span class="w"> </span>--length<span class="o">=</span><span class="m">10</span><span class="w"> </span>--url<span class="o">=</span>https://www.dataquest.io/blog/learn-data-science/<span class="w"> </span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>!sumy lex-rank --length=10 --url=https://www.dataquest.io/blog/learn-data-science/ 
</pre></div>
</div>
</div>
</div>
<p><a class="reference external" href="https://github.com/miso-belica/sumy">Link to Sumy</a>.</p>
</section>
<section id="spacy-streamlit-create-a-web-app-to-visualize-your-text-in-3-lines-of-code">
<h2><span class="section-number">6.6.4. </span>Spacy_streamlit: Create a Web App to Visualize Your Text in 3 Lines of Code<a class="headerlink" href="#spacy-streamlit-create-a-web-app-to-visualize-your-text-in-3-lines-of-code" title="Permalink to this heading">#</a></h2>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>!pip install spacy-streamlit
</pre></div>
</div>
</div>
</details>
</div>
<p>To quickly create an app to visualize the structure of a text, use spacy_streamlit.</p>
<p>To understand how to use spacy_streamlit, we add the code below to a file called <code class="docutils literal notranslate"><span class="pre">streamlit_app.py</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">writefile</span> <span class="n">streamlit_app</span><span class="o">.</span><span class="n">py</span>
<span class="kn">import</span> <span class="nn">spacy_streamlit</span> 

<span class="n">models</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;en_core_web_sm&#39;</span><span class="p">]</span>
<span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;Today is a beautiful day&quot;</span>
<span class="n">spacy_streamlit</span><span class="o">.</span><span class="n">visualize</span><span class="p">(</span><span class="n">models</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>On your terminal, type:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>streamlit<span class="w"> </span>run<span class="w"> </span>streamlit_app.py
</pre></div>
</div>
<p>Output:</p>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>!python -m spacy download en_core_web_sm
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>!streamlit run streamlit_app.py
</pre></div>
</div>
</div>
</details>
</div>
<p>Click the URL and you should see something like below:</p>
<p><img alt="image" src="../_images/streamlit_app.png" /></p>
<p><a class="reference external" href="https://spacy.io/universe/project/spacy-streamlit">Link to spacy-streamlit</a>.</p>
</section>
<section id="textacy-extract-a-contiguous-sequence-of-words">
<h2><span class="section-number">6.6.5. </span>textacy: Extract a Contiguous Sequence of Words<a class="headerlink" href="#textacy-extract-a-contiguous-sequence-of-words" title="Permalink to this heading">#</a></h2>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>!pip install spacy textacy
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>!python -m spacy download en_core_web_sm
</pre></div>
</div>
</div>
</details>
</div>
<p>To extract sequences of words (n-grams), use the <code class="docutils literal notranslate"><span class="pre">textacy</span></code> library:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">spacy</span>
<span class="kn">from</span> <span class="nn">textacy.extract</span> <span class="kn">import</span> <span class="n">ngrams</span>

<span class="n">nlp</span> <span class="o">=</span> <span class="n">spacy</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;en_core_web_sm&quot;</span><span class="p">)</span>

<span class="n">text</span> <span class="o">=</span> <span class="n">nlp</span><span class="p">(</span><span class="s2">&quot;Ice cream is a soft frozen food made with sweetened and flavored milk fat.&quot;</span><span class="p">)</span>

<span class="c1"># extract sequences of 3 words</span>
<span class="p">[</span><span class="n">n</span><span class="o">.</span><span class="n">text</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">ngrams</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">3</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<p><a class="reference external" href="https://textacy.readthedocs.io/en/stable/quickstart.html#working-with-text">Link to textacy</a></p>
</section>
<section id="num2words-convert-number-to-words">
<h2><span class="section-number">6.6.6. </span>Num2Words: Convert Number to Words<a class="headerlink" href="#num2words-convert-number-to-words" title="Permalink to this heading">#</a></h2>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>!pip install num2words
</pre></div>
</div>
</div>
</details>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">num2words</span></code> library helps convert numerical values into words, making NLP tasks like matching numeric data to their textual equivalents easier:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">num2words</span> <span class="kn">import</span> <span class="n">num2words</span>

<span class="n">num2words</span><span class="p">(</span><span class="mi">2019</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">num2words</span><span class="p">(</span><span class="mi">2019</span><span class="p">,</span> <span class="n">to</span><span class="o">=</span><span class="s1">&#39;ordinal&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">num2words</span><span class="p">(</span><span class="mi">2019</span><span class="p">,</span> <span class="n">to</span><span class="o">=</span><span class="s1">&#39;ordinal_num&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">num2words</span><span class="p">(</span><span class="mi">2019</span><span class="p">,</span> <span class="n">to</span><span class="o">=</span><span class="s1">&#39;year&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>It also supports multiple languages:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">num2words</span><span class="p">(</span><span class="mi">2019</span><span class="p">,</span> <span class="n">lang</span><span class="o">=</span><span class="s1">&#39;vi&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">num2words</span><span class="p">(</span><span class="mi">2019</span><span class="p">,</span> <span class="n">lang</span><span class="o">=</span><span class="s1">&#39;es&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><a class="reference external" href="https://bit.ly/3VkWYJO">Link to num2words</a>.</p>
</section>
<section id="numerizer-standardizing-numerical-data-in-text">
<h2><span class="section-number">6.6.7. </span>Numerizer: Standardizing Numerical Data in Text<a class="headerlink" href="#numerizer-standardizing-numerical-data-in-text" title="Permalink to this heading">#</a></h2>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>!pip install numerizer
</pre></div>
</div>
</div>
</details>
</div>
<p>Converting textual numbers to numeric values is challenging due to diverse language representations.</p>
<p>Numerizer simplifies this process by turning various text formats into corresponding numbers.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">numerizer</span> <span class="kn">import</span> <span class="n">numerize</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">numerize</span><span class="p">(</span><span class="s1">&#39;four hundred and sixty two&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">numerize</span><span class="p">(</span><span class="s1">&#39;four hundred sixty two&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">numerize</span><span class="p">(</span><span class="s1">&#39;four sixty two&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">numerize</span><span class="p">(</span><span class="s1">&#39;four sixty-two&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><a class="reference external" href="https://github.com/jaidevd/numerizer">Link to numerizer</a>.</p>
</section>
<section id="preprocess-text-in-one-line-of-code-with-texthero">
<h2><span class="section-number">6.6.8. </span>Preprocess Text in One Line of Code with Texthero<a class="headerlink" href="#preprocess-text-in-one-line-of-code-with-texthero" title="Permalink to this heading">#</a></h2>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>!pip install texthero
</pre></div>
</div>
</div>
</details>
</div>
<p>Processing text in a DataFrame often involves writing lengthy code. Texthero simplifies this by enabling one-line preprocessing, including:</p>
<ul class="simple">
<li><p>filling missing values</p></li>
<li><p>converting upper case to lower case</p></li>
<li><p>removing digits</p></li>
<li><p>removing punctuation</p></li>
<li><p>removing stopwords</p></li>
<li><p>removing whitespace</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">texthero</span> <span class="k">as</span> <span class="nn">hero</span>

<span class="n">text</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;Today is a    beautiful day&quot;</span><span class="p">,</span>
    <span class="s2">&quot;There are 3 ducks in this pond&quot;</span><span class="p">,</span>
    <span class="s2">&quot;This is. very cool.&quot;</span><span class="p">,</span>
    <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span>
<span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="n">text</span><span class="p">})</span>

<span class="n">df</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">hero</span><span class="o">.</span><span class="n">clean</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>You can also create a custom cleaning pipeline by chaining different processing methods.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">(</span>
    <span class="n">df</span><span class="o">.</span><span class="n">text</span>
    <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">hero</span><span class="o">.</span><span class="n">fillna</span><span class="p">)</span>
    <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">hero</span><span class="o">.</span><span class="n">remove_punctuation</span><span class="p">)</span>
    <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">hero</span><span class="o">.</span><span class="n">remove_stopwords</span><span class="p">)</span>
    <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">hero</span><span class="o">.</span><span class="n">remove_whitespace</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><a class="reference external" href="https://github.com/jbesomi/texthero">Link to texthero</a>.</p>
</section>
<section id="texthero-reduce-dimension-and-visualize-text-in-one-line-of-code">
<h2><span class="section-number">6.6.9. </span>texthero: Reduce Dimension and Visualize Text in One Line of Code<a class="headerlink" href="#texthero-reduce-dimension-and-visualize-text-in-one-line-of-code" title="Permalink to this heading">#</a></h2>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>!pip install &#39;gensim==3.6.0&#39;
!pip install &#39;texthero==1.1.0&#39;
!pip install unidecode
</pre></div>
</div>
</div>
</details>
</div>
<p>To visualize text data in 2D, typically, you need to clean, encode, and reduce the dimensions of your text, which can be tedious. Texthero simplifies this process into just two lines of code.</p>
<p>Below is an example using descriptions from <a class="reference external" href="https://www.kaggle.com/datasets/hadasu92/cnn-articles-after-basic-cleaning">CNN news articles</a>. Each point represents an article, colored by its category.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">texthero</span> <span class="k">as</span> <span class="nn">hero</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;small_CNN.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;pca&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Description&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">hero</span><span class="o">.</span><span class="n">clean</span><span class="p">)</span><span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">hero</span><span class="o">.</span><span class="n">tfidf</span><span class="p">)</span><span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">hero</span><span class="o">.</span><span class="n">pca</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span> 

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">hero</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;pca&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;Category&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;CNN News&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="" src="../_images/texthero_scatter.png" /></p>
<p><a class="reference external" href="https://github.com/jbesomi/texthero">Link to texthero</a>.</p>
</section>
<section id="wordfreq-estimate-the-frequency-of-a-word-in-36-languages">
<h2><span class="section-number">6.6.10. </span>wordfreq: Estimate the Frequency of a Word in 36 Languages<a class="headerlink" href="#wordfreq-estimate-the-frequency-of-a-word-in-36-languages" title="Permalink to this heading">#</a></h2>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>!pip install wordfreq
</pre></div>
</div>
</div>
</details>
</div>
<p>If you need to check the frequency of a word in 36 different languages, <code class="docutils literal notranslate"><span class="pre">wordfreq</span></code> is an excellent tool.</p>
<p>It even covers words that occur as infrequently as once per 10 million words.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">from</span> <span class="nn">wordfreq</span> <span class="kn">import</span> <span class="n">word_frequency</span>

<span class="n">word_frequency</span><span class="p">(</span><span class="s2">&quot;eat&quot;</span><span class="p">,</span> <span class="s2">&quot;en&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">word_frequency</span><span class="p">(</span><span class="s2">&quot;the&quot;</span><span class="p">,</span> <span class="s2">&quot;en&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sentence</span> <span class="o">=</span> <span class="s2">&quot;There is a dog running in a park&quot;</span>
<span class="n">words</span> <span class="o">=</span> <span class="n">sentence</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
<span class="n">word_frequencies</span> <span class="o">=</span> <span class="p">[</span><span class="n">word_frequency</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="s2">&quot;en&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">words</span><span class="p">]</span>

<span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">words</span><span class="p">,</span> <span class="n">word_frequencies</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p><a class="reference external" href="https://github.com/khuyentran1401/Python-data-science-code-snippet/blob/master/code_snippets/data_science_tools/wordfreq_example.py">Link to wordfreq</a>.</p>
</section>
<section id="newspaper3k-extract-meaningful-information-from-an-articles-in-2-lines-of-code">
<h2><span class="section-number">6.6.11. </span>newspaper3k: Extract Meaningful Information From an Articles in 2 Lines of Code<a class="headerlink" href="#newspaper3k-extract-meaningful-information-from-an-articles-in-2-lines-of-code" title="Permalink to this heading">#</a></h2>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>!pip install newspaper3k nltk
</pre></div>
</div>
</div>
</details>
</div>
<p>To quickly extract meaningful information from an article in a few lines of code, use <code class="docutils literal notranslate"><span class="pre">newspaper3k</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">newspaper</span> <span class="kn">import</span> <span class="n">Article</span>
<span class="kn">import</span> <span class="nn">nltk</span>

<span class="n">nltk</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="s2">&quot;punkt&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://mathdatasimplified.com/2023/05/08/build-an-efficient-data-pipeline-is-dbt-the-key/&quot;</span>
<span class="n">article</span> <span class="o">=</span> <span class="n">Article</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="n">article</span><span class="o">.</span><span class="n">download</span><span class="p">()</span>
<span class="n">article</span><span class="o">.</span><span class="n">parse</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">article</span><span class="o">.</span><span class="n">title</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">article</span><span class="o">.</span><span class="n">publish_date</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">article</span><span class="o">.</span><span class="n">top_image</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">article</span><span class="o">.</span><span class="n">nlp</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">article</span><span class="o">.</span><span class="n">summary</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">article</span><span class="o">.</span><span class="n">keywords</span>
</pre></div>
</div>
</div>
</div>
<p><a class="reference external" href="https://github.com/codelucas/newspaper">Link to newspaper3k</a>.</p>
</section>
<section id="questgen-ai-question-generator-in-python">
<h2><span class="section-number">6.6.12. </span><a class="reference external" href="http://Questgen.ai">Questgen.ai</a>: Question Generator in Python<a class="headerlink" href="#questgen-ai-question-generator-in-python" title="Permalink to this heading">#</a></h2>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>!pip install git+https://github.com/ramsrigouthamg/Questgen.ai
!pip install git+https://github.com/boudinfl/pke.git

!python -m nltk.downloader universal_tagset
!python -m spacy download en 
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>!wget https://github.com/explosion/sense2vec/releases/download/v1.0.0/s2v_reddit_2015_md.tar.gz
!tar -xvf  s2v_reddit_2015_md.tar.gz
</pre></div>
</div>
</div>
</details>
</div>
<p>Generating questions manually from a document can be time-consuming. <code class="docutils literal notranslate"><span class="pre">Questgen.ai</span></code> automates this task, allowing you to quickly generate Boolean or FAQ-style questions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="n">pprint</span>
<span class="kn">import</span> <span class="nn">nltk</span>
<span class="n">nltk</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="s1">&#39;stopwords&#39;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">Questgen</span> <span class="kn">import</span> <span class="n">main</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">payload</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;input_text&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;&quot;The weather today was nice so I went for a walk. I stopped for a quick chat with my neighbor.</span>
<span class="s2">    It turned out that my neighbor just got a dog named Pepper. It is a black Labrador Retriever.&quot;&quot;&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">qe</span> <span class="o">=</span> <span class="n">main</span><span class="o">.</span><span class="n">BoolQGen</span><span class="p">()</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">qe</span><span class="o">.</span><span class="n">predict_boolq</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">output</span> <span class="o">=</span> <span class="n">qg</span><span class="o">.</span><span class="n">predict_shortq</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><a class="reference external" href="https://github.com/ramsrigouthamg/Questgen.ai">Link to Questgen.ai</a>.</p>
</section>
<section id="word-ninja-slice-your-lumped-together-words">
<h2><span class="section-number">6.6.13. </span>Word Ninja: Slice Your Lumped-Together Words<a class="headerlink" href="#word-ninja-slice-your-lumped-together-words" title="Permalink to this heading">#</a></h2>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>!pip install wordninja 
</pre></div>
</div>
</div>
</details>
</div>
<p>Want to split compound words? <code class="docutils literal notranslate"><span class="pre">Word</span> <span class="pre">Ninja</span></code> is surprisingly effective at doing just that. Here are a few examples:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">wordninja</span> 

<span class="n">wordninja</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;honeyinthejar&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">wordninja</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;ihavetwoapples&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">wordninja</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;aratherblusterday&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><a class="reference external" href="https://github.com/keredson/wordninja">Link to Word Ninja</a>.</p>
</section>
<section id="textstat-calculate-statistics-from-text">
<h2><span class="section-number">6.6.14. </span>textstat: Calculate Statistics From Text<a class="headerlink" href="#textstat-calculate-statistics-from-text" title="Permalink to this heading">#</a></h2>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>!pip install textstat
</pre></div>
</div>
</div>
</details>
</div>
<p>To analyze text statistics such as readability scores and reading time, use the <code class="docutils literal notranslate"><span class="pre">textstat</span></code> library.</p>
<p>To calculate the Automated Readability Index (ARI), which indicates the grade level required to understand a text, use <code class="docutils literal notranslate"><span class="pre">automated_readability_index</span></code>. For example, an ARI of 10.8 means the text is suitable for 10th to 11th graders.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">textstat</span> 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;The working memory system is a form of conscious learning. But not all learning is conscious. Psychologists have long marveled at children‚Äôs ability to acquire perfect pronunciation in their first language or recognize faces.&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">textstat</span><span class="o">.</span><span class="n">automated_readability_index</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>You can also measure the reading time of a text in seconds using <code class="docutils literal notranslate"><span class="pre">reading_time</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">textstat</span><span class="o">.</span><span class="n">reading_time</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">ms_per_char</span><span class="o">=</span><span class="mf">14.69</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><a class="reference external" href="https://github.com/shivam5992/textstat">Link to textstat</a>.</p>
</section>
<section id="rapidfuzz-rapid-string-matching-in-python">
<h2><span class="section-number">6.6.15. </span>RapidFuzz: Rapid String Matching in Python<a class="headerlink" href="#rapidfuzz-rapid-string-matching-in-python" title="Permalink to this heading">#</a></h2>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>!pip install rapidfuzz
</pre></div>
</div>
</div>
</details>
</div>
<p>To find similar strings efficiently, use the <code class="docutils literal notranslate"><span class="pre">RapidFuzz</span></code> library.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">rapidfuzz</span> <span class="kn">import</span> <span class="n">fuzz</span>
</pre></div>
</div>
</div>
</div>
<p>You can calculate the similarity ratio between two strings using the <code class="docutils literal notranslate"><span class="pre">fuzz.ratio</span></code> function:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fuzz</span><span class="o">.</span><span class="n">ratio</span><span class="p">(</span><span class="s2">&quot;Let&#39;s meet at 10 am tomorrow&quot;</span><span class="p">,</span> <span class="s2">&quot;Let&#39;s meet at 10 am tommorrow&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fuzz</span><span class="o">.</span><span class="n">ratio</span><span class="p">(</span><span class="s2">&quot;here you go&quot;</span><span class="p">,</span> <span class="s2">&quot;you go here&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>For token sorting and matching, use <code class="docutils literal notranslate"><span class="pre">token_sort_ratio</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fuzz</span><span class="o">.</span><span class="n">token_sort_ratio</span><span class="p">(</span><span class="s2">&quot;here you go&quot;</span><span class="p">,</span> <span class="s2">&quot;you go here&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><a class="reference external" href="https://github.com/maxbachmann/RapidFuzz">Link to RapidFuzz</a>.</p>
</section>
<section id="checklist-create-data-to-test-your-nlp-model">
<h2><span class="section-number">6.6.16. </span>Checklist: Create Data to Test Your NLP Model<a class="headerlink" href="#checklist-create-data-to-test-your-nlp-model" title="Permalink to this heading">#</a></h2>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>!pip install checklist torch
</pre></div>
</div>
</div>
</details>
</div>
<p>It can be time-consuming to create data to test edge cases of your NLP model. To quickly create data to test your NLP models, use <code class="docutils literal notranslate"><span class="pre">Checklist</span></code>.</p>
<p>In the code below, I use Checklist‚Äôs <code class="docutils literal notranslate"><span class="pre">Editor</span></code> to create multiple examples of negation in one line of code.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">checklist</span>
<span class="kn">from</span> <span class="nn">checklist.editor</span> <span class="kn">import</span> <span class="n">Editor</span>

<span class="n">editor</span> <span class="o">=</span> <span class="n">Editor</span><span class="p">()</span>
<span class="n">editor</span><span class="o">.</span><span class="n">template</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{mask}</span><span class="s2"> is not {a:pos} option.&quot;</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;good&quot;</span><span class="p">,</span> <span class="s2">&quot;cool&quot;</span><span class="p">],</span> <span class="n">nsamples</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">data</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">editor</span><span class="o">.</span><span class="n">template</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{mask}</span><span class="s2"> is not {a:neg} option.&quot;</span><span class="p">,</span> <span class="n">neg</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;bad&quot;</span><span class="p">,</span> <span class="s2">&quot;awful&quot;</span><span class="p">],</span> <span class="n">nsamples</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">data</span>
</pre></div>
</div>
</div>
</div>
<p><a class="reference external" href="https://github.com/marcotcr/checklist">Link to Checklist</a>.</p>
</section>
<section id="top2vec-quick-topic-modeling-in-python">
<h2><span class="section-number">6.6.17. </span>Top2Vec: Quick Topic Modeling in Python<a class="headerlink" href="#top2vec-quick-topic-modeling-in-python" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>!pip install top2vec
</pre></div>
</div>
</div>
</div>
<p>Manually identifying topics from large text collections and having to specify the number of topics beforehand results in subjective, inconsistent topic modeling and requires significant trial and error.</p>
<p>Top2Vec automatically discovers topics by finding dense clusters of semantically similar documents and identifying the words that attract those documents together.</p>
<p>In this example, we will use the Top2Vec library to detect topics in a dataset of fake news articles.</p>
<p>Load the ‚ÄúFake-News‚Äù dataset from OpenML:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">top2vec</span> <span class="kn">import</span> <span class="n">Top2Vec</span>
<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">fetch_openml</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">news</span> <span class="o">=</span> <span class="n">fetch_openml</span><span class="p">(</span><span class="s2">&quot;Fake-News&quot;</span><span class="p">)</span>
<span class="n">text</span> <span class="o">=</span> <span class="n">news</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Create a Top2Vec model with the text data, using the ‚Äúlearn‚Äù speed and 8 worker threads:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">Top2Vec</span><span class="p">(</span><span class="n">documents</span><span class="o">=</span><span class="n">text</span><span class="p">,</span> <span class="n">speed</span><span class="o">=</span><span class="s2">&quot;learn&quot;</span><span class="p">,</span> <span class="n">workers</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Get the number of topics detected by the model:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">get_num_topics</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>In this example, Top2Vec automatically determines the number and content of topics by analyzing document similarities in the embedding space</p>
<p>Get the topics in decreasing size:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">topic_words</span><span class="p">,</span> <span class="n">word_scores</span><span class="p">,</span> <span class="n">topic_nums</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_topics</span><span class="p">(</span><span class="mi">72</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Second Topic - Top 5 Words and Scores:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">word</span><span class="p">,</span> <span class="n">score</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">topic_words</span><span class="p">[</span><span class="mi">1</span><span class="p">][:</span><span class="mi">5</span><span class="p">],</span> <span class="n">word_scores</span><span class="p">[</span><span class="mi">1</span><span class="p">][:</span><span class="mi">5</span><span class="p">]):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Word: </span><span class="si">{</span><span class="n">word</span><span class="si">:</span><span class="s2">&lt;20</span><span class="si">}</span><span class="s2"> Score: </span><span class="si">{</span><span class="n">score</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Second Topic - Top 5 Words: </span><span class="si">{</span><span class="n">topic_words</span><span class="p">[</span><span class="mi">1</span><span class="p">][:</span><span class="mi">5</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Search for topics most similar to the keyword ‚Äúpresident‚Äù:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">topic_words</span><span class="p">,</span> <span class="n">word_scores</span><span class="p">,</span> <span class="n">topic_scores</span><span class="p">,</span> <span class="n">topic_nums</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">search_topics</span><span class="p">(</span><span class="n">keywords</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;president&quot;</span><span class="p">],</span> <span class="n">num_topics</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">first_five_words</span> <span class="o">=</span> <span class="p">[</span><span class="n">topic</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span> <span class="k">for</span> <span class="n">topic</span> <span class="ow">in</span> <span class="n">topic_words</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Topics most similar to president:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">topic_num</span><span class="p">,</span> <span class="n">words</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">topic_nums</span><span class="p">,</span> <span class="n">first_five_words</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Topic </span><span class="si">{</span><span class="n">topic_num</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">words</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Generate word clouds for the topics most similar to ‚Äúpresident‚Äù:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">topic</span> <span class="ow">in</span> <span class="n">topic_nums</span><span class="p">:</span>
    <span class="n">model</span><span class="o">.</span><span class="n">generate_topic_wordcloud</span><span class="p">(</span><span class="n">topic</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><a class="reference external" href="https://github.com/ddangelov/Top2Vec">Link to Top2Vec</a>.</p>
</section>
<section id="expanding-english-contractions-in-text">
<h2><span class="section-number">6.6.18. </span>Expanding English Contractions in Text<a class="headerlink" href="#expanding-english-contractions-in-text" title="Permalink to this heading">#</a></h2>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>!pip install contractions
</pre></div>
</div>
</div>
</details>
</div>
<p>Contraction can cause issues when processing text. To expand contractions using Python, use the library contractions</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">contractions</span>

<span class="n">sent</span> <span class="o">=</span> <span class="s2">&quot;I&#39;m not sure, but I&#39;d like to do it&quot;</span>

<span class="n">contractions</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="n">sent</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="inflect-generate-plurals-singulars-and-indefinite-articles">
<h2><span class="section-number">6.6.19. </span>inflect: Generate Plurals, Singulars, and Indefinite Articles<a class="headerlink" href="#inflect-generate-plurals-singulars-and-indefinite-articles" title="Permalink to this heading">#</a></h2>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>!pip install inflect 
</pre></div>
</div>
</div>
</details>
</div>
<p>To generate plurals, singulars, or indefinite articles from given words, use inflect.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">inflect</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">inflect</span><span class="o">.</span><span class="n">engine</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">p</span><span class="o">.</span><span class="n">plural_noun</span><span class="p">(</span><span class="s1">&#39;he&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">p</span><span class="o">.</span><span class="n">plural_verb</span><span class="p">(</span><span class="s1">&#39;sees&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">p</span><span class="o">.</span><span class="n">gender</span><span class="p">(</span><span class="s2">&quot;feminine&quot;</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">singular_noun</span><span class="p">(</span><span class="s2">&quot;they&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">p</span><span class="o">.</span><span class="n">compare_verbs</span><span class="p">(</span><span class="s1">&#39;sees&#39;</span><span class="p">,</span> <span class="s1">&#39;see&#39;</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;same word&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Add the correct &quot;a&quot; or &quot;an&quot; for a given word</span>
<span class="n">fruit1</span> <span class="o">=</span> <span class="s1">&#39;apple&#39;</span>
<span class="n">fruit2</span> <span class="o">=</span> <span class="s1">&#39;banana&#39;</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;I got you </span><span class="si">{</span><span class="n">p</span><span class="o">.</span><span class="n">a</span><span class="p">(</span><span class="n">fruit1</span><span class="p">)</span><span class="si">}</span><span class="s2"> &quot;</span>
      <span class="sa">f</span><span class="s2">&quot;and </span><span class="si">{</span><span class="n">p</span><span class="o">.</span><span class="n">a</span><span class="p">(</span><span class="n">fruit2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><a class="reference external" href="https://github.com/jaraco/inflect">Link to inflect</a>.</p>
</section>
<section id="ekphrasis-text-processing-tool-for-social-media-text">
<h2><span class="section-number">6.6.20. </span>ekphrasis: Text Processing Tool For Social Media Text<a class="headerlink" href="#ekphrasis-text-processing-tool-for-social-media-text" title="Permalink to this heading">#</a></h2>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>!pip install ekphrasis==0.5.4
</pre></div>
</div>
</div>
</details>
</div>
<p>It is challenging to process text from social media such as Twitter or Facebook. ekphrasis allows you to incorporate social tokenizers, word segmentation, spell correction, and more into a pipeline to process those texts.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ekphrasis.classes.preprocessor</span> <span class="kn">import</span> <span class="n">TextPreProcessor</span>
<span class="kn">from</span> <span class="nn">ekphrasis.classes.tokenizer</span> <span class="kn">import</span> <span class="n">SocialTokenizer</span>
<span class="kn">from</span> <span class="nn">ekphrasis.dicts.emoticons</span> <span class="kn">import</span> <span class="n">emoticons</span>

<span class="n">text_processor</span> <span class="o">=</span> <span class="n">TextPreProcessor</span><span class="p">(</span>
    <span class="c1"># terms that will be normalized</span>
    <span class="n">normalize</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;url&#39;</span><span class="p">,</span> <span class="s1">&#39;user&#39;</span><span class="p">],</span>
    <span class="c1"># terms that will be annotated</span>
    <span class="n">annotate</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;hashtag&quot;</span><span class="p">,</span> <span class="s2">&quot;allcaps&quot;</span><span class="p">,</span> <span class="s2">&quot;elongated&quot;</span><span class="p">,</span> <span class="s2">&quot;repeated&quot;</span><span class="p">,</span>
        <span class="s1">&#39;emphasis&#39;</span><span class="p">,</span> <span class="s1">&#39;censored&#39;</span><span class="p">},</span>
    
    <span class="c1"># corpus for word segmentation </span>
    <span class="n">segmenter</span><span class="o">=</span><span class="s2">&quot;twitter&quot;</span><span class="p">,</span> 
    
    <span class="n">unpack_hashtags</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="c1"># perform word segmentation on hashtags</span>
    <span class="n">unpack_contractions</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="c1"># Unpack contractions (can&#39;t -&gt; can not)</span>
    <span class="n">spell_correct_elong</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>  <span class="c1"># spell correction for elongated words</span>

    <span class="n">tokenizer</span><span class="o">=</span><span class="n">SocialTokenizer</span><span class="p">(</span><span class="n">lowercase</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">tokenize</span><span class="p">,</span>
    
    <span class="c1"># Replace emojis with words</span>
    <span class="n">dicts</span><span class="o">=</span><span class="p">[</span><span class="n">emoticons</span><span class="p">]</span>
<span class="p">)</span>

<span class="n">sent</span> <span class="o">=</span> <span class="s2">&quot;@coolyazzy94 I&#39;m learning to retweeeet!! Least it sucks LESS than Facebook haha :P #learn-twitter https://t.co/7RdyMCVPKx&quot;</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">text_processor</span><span class="o">.</span><span class="n">pre_process_doc</span><span class="p">(</span><span class="n">sent</span><span class="p">)))</span>
</pre></div>
</div>
</div>
</div>
<p><a class="reference external" href="https://github.com/cbaziotis/ekphrasis">Link to ekphrasis</a>.</p>
</section>
<section id="chroma-the-lightning-fast-solution-to-text-embeddings-and-querying">
<h2><span class="section-number">6.6.21. </span>Chroma: The Lightning-Fast Solution to Text Embeddings and Querying<a class="headerlink" href="#chroma-the-lightning-fast-solution-to-text-embeddings-and-querying" title="Permalink to this heading">#</a></h2>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>!pip install chromadb
</pre></div>
</div>
</div>
</details>
</div>
<p>Semantic search uses embedding to understand the meaning of search queries instead of relying solely on keyword matches to locate documents.</p>
<p>Embedding is like a translator converting words into numbers so that computers can understand. Chroma makes it easy to create embeddings from documents and find similar results with a few lines of code.</p>
<p>In the code below, the documents with IDs 1 and 2 closely match the given query text.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">chromadb</span>

<span class="n">client</span> <span class="o">=</span> <span class="n">chromadb</span><span class="o">.</span><span class="n">Client</span><span class="p">()</span>

<span class="n">collection</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get_or_create_collection</span><span class="p">(</span><span class="s2">&quot;test&quot;</span><span class="p">)</span>

<span class="n">collection</span><span class="o">.</span><span class="n">add</span><span class="p">(</span>
    <span class="n">documents</span><span class="o">=</span><span class="p">[</span>
        <span class="s2">&quot;A man is eating food.&quot;</span><span class="p">,</span>
        <span class="s2">&quot;A man is eating yellow noodles.&quot;</span><span class="p">,</span>
        <span class="s2">&quot;The girl is carrying a baby.&quot;</span><span class="p">,</span>
        <span class="s2">&quot;A man is riding a horse.&quot;</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="n">ids</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;2&quot;</span><span class="p">,</span> <span class="s2">&quot;3&quot;</span><span class="p">,</span> <span class="s2">&quot;4&quot;</span><span class="p">],</span>
<span class="p">)</span>

<span class="n">query_result</span> <span class="o">=</span> <span class="n">collection</span><span class="o">.</span><span class="n">query</span><span class="p">(</span>
    <span class="n">query_texts</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;A man is eating pasta.&quot;</span> <span class="p">],</span>
    <span class="n">n_results</span><span class="o">=</span><span class="mi">2</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">query_result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><a class="reference external" href="https://github.com/chroma-core/chroma">Link to Chroma</a>.</p>
</section>
<section id="galatic-clean-and-analyze-massive-text-datasets">
<h2><span class="section-number">6.6.22. </span>Galatic: Clean and Analyze Massive Text Datasets<a class="headerlink" href="#galatic-clean-and-analyze-massive-text-datasets" title="Permalink to this heading">#</a></h2>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>!pip install galactic-ai
</pre></div>
</div>
</div>
</details>
</div>
<p>To clean, gain insights, and create embeddings from massive unstructured text datasets, use Galatic.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">galactic</span> <span class="kn">import</span> <span class="n">GalacticDataset</span>


<span class="n">filter_func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s2">&quot;content&quot;</span><span class="p">])</span> <span class="o">&lt;</span> <span class="mi">1024</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">GalacticDataset</span><span class="o">.</span><span class="n">from_hugging_face_stream</span><span class="p">(</span>
    <span class="s2">&quot;tiiuae/falcon-refinedweb&quot;</span><span class="p">,</span>
    <span class="n">split</span><span class="o">=</span><span class="s2">&quot;train&quot;</span><span class="p">,</span>
    <span class="n">filters</span><span class="o">=</span><span class="p">[</span><span class="n">filter_func</span><span class="p">],</span>
    <span class="n">dedup_fields</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;content&quot;</span><span class="p">],</span>
    <span class="n">max_samples</span><span class="o">=</span><span class="mi">5000</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Detect the language of the text</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">Counter</span>
<span class="n">dataset</span><span class="o">.</span><span class="n">detect_language</span><span class="p">(</span><span class="n">field</span><span class="o">=</span><span class="s2">&quot;content&quot;</span><span class="p">)</span>
<span class="n">Counter</span><span class="p">(</span><span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;__language&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Counter</span><span class="p">({</span><span class="s1">&#39;en&#39;</span><span class="p">:</span> <span class="mi">4975</span><span class="p">,</span>
         <span class="s1">&#39;es&#39;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
         <span class="s1">&#39;fr&#39;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
         <span class="s1">&#39;de&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
         <span class="s1">&#39;da&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
         <span class="s1">&#39;ru&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
         <span class="s1">&#39;nl&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
         <span class="s1">&#39;pt&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
         <span class="s1">&#39;sh&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
         <span class="s1">&#39;eo&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
         <span class="s1">&#39;ceb&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get personal information from the text</span>
<span class="n">dataset</span><span class="o">.</span><span class="n">detect_pii</span><span class="p">(</span>
    <span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;content&quot;</span><span class="p">]</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Email:&quot;</span><span class="p">,</span> <span class="nb">sum</span><span class="p">(</span><span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;__pii__email&quot;</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Phone:&quot;</span><span class="p">,</span> <span class="nb">sum</span><span class="p">(</span><span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;__pii__phone&quot;</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Username/Password:&quot;</span><span class="p">,</span> <span class="nb">sum</span><span class="p">(</span><span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;__pii__credential&quot;</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Filter out all examples that have &quot;blogspot&quot; in the URL.</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">filter_string</span><span class="p">(</span>
    <span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;url&quot;</span><span class="p">],</span>
    <span class="n">values</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;blogspot&quot;</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create embeddings</span>
<span class="n">dataset</span><span class="o">.</span><span class="n">get_embeddings</span><span class="p">(</span><span class="n">input_field</span><span class="o">=</span><span class="s2">&quot;content&quot;</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="s2">&quot;cpu&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Cluster the embeddings with kmeans</span>
<span class="n">dataset</span><span class="o">.</span><span class="n">cluster</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">dataset</span><span class="o">.</span><span class="n">get_cluster_info</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p><a class="reference external" href="https://github.com/taylorai/galactic">Link to Galatic</a>.</p>
</section>
<section id="efficient-keyword-extraction-and-replacement-with-flashtext">
<h2><span class="section-number">6.6.23. </span>Efficient Keyword Extraction and Replacement with FlashText<a class="headerlink" href="#efficient-keyword-extraction-and-replacement-with-flashtext" title="Permalink to this heading">#</a></h2>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>!pip install flashtext
</pre></div>
</div>
</div>
</details>
</div>
<p>If you want to perform fast keyword extraction and replacement in text, use FlashText.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">flashtext</span> <span class="kn">import</span> <span class="n">KeywordProcessor</span>

<span class="n">keyword_processor</span> <span class="o">=</span> <span class="n">KeywordProcessor</span><span class="p">()</span>

<span class="c1"># Adding keywords with replacements</span>
<span class="n">keyword_processor</span><span class="o">.</span><span class="n">add_keyword</span><span class="p">(</span><span class="n">keyword</span><span class="o">=</span><span class="s2">&quot;Python&quot;</span><span class="p">)</span>
<span class="n">keyword_processor</span><span class="o">.</span><span class="n">add_keyword</span><span class="p">(</span><span class="n">keyword</span><span class="o">=</span><span class="s2">&quot;DS&quot;</span><span class="p">,</span> <span class="n">clean_name</span><span class="o">=</span><span class="s2">&quot;data science&quot;</span><span class="p">)</span>

<span class="c1"># Replacing keywords in text</span>
<span class="n">new_sentence</span> <span class="o">=</span> <span class="n">keyword_processor</span><span class="o">.</span><span class="n">replace_keywords</span><span class="p">(</span><span class="s2">&quot;PYTHON is essential for DS.&quot;</span><span class="p">)</span>
<span class="n">new_sentence</span>
</pre></div>
</div>
</div>
</div>
<p><a class="reference external" href="https://bit.ly/4bQ1eqt">Link to FlashText</a>.</p>
</section>
<section id="bertopic-harnessing-bert-for-interpretable-topic-modeling">
<h2><span class="section-number">6.6.24. </span>BERTopic: Harnessing BERT for Interpretable Topic Modeling<a class="headerlink" href="#bertopic-harnessing-bert-for-interpretable-topic-modeling" title="Permalink to this heading">#</a></h2>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>!pip install bertopic
</pre></div>
</div>
</div>
</details>
</div>
<p>Managing and understanding large collections of text documents results in complex workflows with multiple preprocessing steps and difficult-to-interpret results. This causes data scientists to spend significant time trying to make sense of their document clusters and explaining them to stakeholders.</p>
<p>With BERTopic, you can leverage state-of-the-art language models to create more meaningful and interpretable topics. You get automatic topic labeling, visualization capabilities, and the flexibility to customize the modeling process according to your needs.</p>
<p>For this example, we use the popular 20 Newsgroups dataset which contains roughly 18000 newsgroups posts</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">fetch_20newsgroups</span>
<span class="n">docs</span> <span class="o">=</span> <span class="n">fetch_20newsgroups</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span>  <span class="n">remove</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;headers&#39;</span><span class="p">,</span> <span class="s1">&#39;footers&#39;</span><span class="p">,</span> <span class="s1">&#39;quotes&#39;</span><span class="p">))[</span><span class="s1">&#39;data&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>In this example, we will go through the main components of BERTopic and the steps necessary to create a strong topic model.</p>
<p>We start by instantiating BERTopic. We set language to <code class="docutils literal notranslate"><span class="pre">english</span></code> since our documents are in the English language.</p>
<div class="cell tag_hide-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">bertopic</span> <span class="kn">import</span> <span class="n">BERTopic</span>

<span class="n">topic_model</span> <span class="o">=</span> <span class="n">BERTopic</span><span class="p">(</span><span class="n">language</span><span class="o">=</span><span class="s2">&quot;english&quot;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">topics</span><span class="p">,</span> <span class="n">probs</span> <span class="o">=</span> <span class="n">topic_model</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">docs</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>After fitting our model, we can start by looking at the results. Typically, we look at the most frequent topics first as they best represent the collection of documents.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">freq</span> <span class="o">=</span> <span class="n">topic_model</span><span class="o">.</span><span class="n">get_topic_info</span><span class="p">()</span>
<span class="n">freq</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>-1 refers to all outliers and should typically be ignored. Next, let‚Äôs take a look at a frequent topic that were generated:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">topic_model</span><span class="o">.</span><span class="n">get_topic</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># Select the most frequent topic</span>
</pre></div>
</div>
</div>
</div>
<p>Access the predicted topics for the first 10 documents:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">topic_model</span><span class="o">.</span><span class="n">topics_</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Visualize topics:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">topic_model</span><span class="o">.</span><span class="n">visualize_topics</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>We can visualize the selected terms for a few topics by creating bar charts out of the c-TF-IDF scores for each topic representation. Insights can be gained from the relative c-TF-IDF scores between and within topics. Moreover, you can easily compare topic representations to each other.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">topic_model</span><span class="o">.</span><span class="n">visualize_barchart</span><span class="p">(</span><span class="n">top_n_topics</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p><a class="reference external" href="https://bit.ly/4fjwU9T">Link to BertTopic</a>.</p>
</section>
<section id="berttopic-enhance-topic-models-with-expert-defined-themes">
<h2><span class="section-number">6.6.25. </span>BertTopic: Enhance Topic Models with Expert-Defined Themes<a class="headerlink" href="#berttopic-enhance-topic-models-with-expert-defined-themes" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>!pip install -U bertopic
</pre></div>
</div>
</div>
</div>
<p>Data scientists and analysts often need to guide their topic modeling process with domain knowledge or specific themes they want to extract, but traditional topic modeling approaches don‚Äôt allow for this kind of control over the generated topics.</p>
<p>BERTopic is a topic modeling library that leverages BERT embeddings and c-TF-IDF to create easily interpretable topics.</p>
<p>Seed words are predefined sets of words that represent themes or topics you expect or want to find in your documents. BERTopic allows you to guide the topic modeling process using these seed words. By providing seed words, you can:</p>
<ul class="simple">
<li><p>Direct the model towards specific themes of interest</p></li>
<li><p>Incorporate domain expertise into the topic discovery process</p></li>
<li><p>Ensure certain important themes are captured</p></li>
</ul>
<p>Here‚Äôs how to implement guided topic modeling with seed words:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">bertopic</span> <span class="kn">import</span> <span class="n">BERTopic</span>
<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">fetch_20newsgroups</span>

<span class="c1"># Load example data</span>
<span class="n">docs</span> <span class="o">=</span> <span class="n">fetch_20newsgroups</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">remove</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;headers&#39;</span><span class="p">,</span> <span class="s1">&#39;footers&#39;</span><span class="p">,</span> <span class="s1">&#39;quotes&#39;</span><span class="p">))[</span><span class="s1">&#39;data&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define seed topics</span>
<span class="n">seed_topic_list</span> <span class="o">=</span> <span class="p">[[</span><span class="s2">&quot;drug&quot;</span><span class="p">,</span> <span class="s2">&quot;cancer&quot;</span><span class="p">,</span> <span class="s2">&quot;drugs&quot;</span><span class="p">,</span> <span class="s2">&quot;doctor&quot;</span><span class="p">],</span>
                   <span class="p">[</span><span class="s2">&quot;windows&quot;</span><span class="p">,</span> <span class="s2">&quot;drive&quot;</span><span class="p">,</span> <span class="s2">&quot;dos&quot;</span><span class="p">,</span> <span class="s2">&quot;file&quot;</span><span class="p">],</span>
                   <span class="p">[</span><span class="s2">&quot;space&quot;</span><span class="p">,</span> <span class="s2">&quot;launch&quot;</span><span class="p">,</span> <span class="s2">&quot;orbit&quot;</span><span class="p">,</span> <span class="s2">&quot;lunar&quot;</span><span class="p">]]</span>

<span class="c1"># Create and train the model with seed topics</span>
<span class="n">topic_model</span> <span class="o">=</span> <span class="n">BERTopic</span><span class="p">(</span><span class="n">seed_topic_list</span><span class="o">=</span><span class="n">seed_topic_list</span><span class="p">)</span>
<span class="n">topics</span><span class="p">,</span> <span class="n">probs</span> <span class="o">=</span> <span class="n">topic_model</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">docs</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Look at three different topics in detail</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">First topic (Sports):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">topic_model</span><span class="o">.</span><span class="n">get_topic</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Second topic (Cryptography):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">topic_model</span><span class="o">.</span><span class="n">get_topic</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Fifth topic (Space Exploration):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">topic_model</span><span class="o">.</span><span class="n">get_topic</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>The results show how seed words influence topic discovery:</p>
<ul class="simple">
<li><p><strong>Seed Word Integration</strong>: In Topic 5, space-related seed words (‚Äòspace‚Äô, ‚Äòlaunch‚Äô, ‚Äòorbit‚Äô, ‚Äòlunar‚Äô) have high weights. The model expands on these words to include related terms like ‚Äòshuttle‚Äô, ‚Äòmission‚Äô, and ‚Äòstation‚Äô.</p></li>
<li><p><strong>Natural Topic Discovery</strong>: The model discovers prominent topics like sports (Topic 0) and cryptography (Topic 1), despite being seeded with medical and computer themes. This shows that seed words guide the model without constraining it.</p></li>
</ul>
<p><a class="reference external" href="https://github.com/MaartenGr/BERTopic">Link to BertTopic</a>.</p>
</section>
<section id="bertviz-visualize-nlp-model-attention-patterns">
<h2><span class="section-number">6.6.26. </span>BertViz: Visualize NLP Model Attention Patterns<a class="headerlink" href="#bertviz-visualize-nlp-model-attention-patterns" title="Permalink to this heading">#</a></h2>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>!pip install bertviz
</pre></div>
</div>
</div>
</details>
</div>
<p>Understanding how attention mechanisms work in transformer models is challenging due to the complex interactions between multiple attention heads across different layers.</p>
<p>BertViz allows you to interactively visualize and explore attention patterns through multiple views.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">transformers</span> <span class="kn">import</span> <span class="n">AutoTokenizer</span><span class="p">,</span> <span class="n">AutoModel</span><span class="p">,</span> <span class="n">utils</span>

<span class="n">utils</span><span class="o">.</span><span class="n">logging</span><span class="o">.</span><span class="n">set_verbosity_error</span><span class="p">()</span>  <span class="c1"># Suppress standard warnings</span>

<span class="c1"># Find popular HuggingFace models here: https://huggingface.co/models</span>
<span class="n">model_name</span> <span class="o">=</span> <span class="s2">&quot;microsoft/xtremedistil-l12-h384-uncased&quot;</span>  
<span class="n">input_text</span> <span class="o">=</span> <span class="s2">&quot;The cat sat on the mat&quot;</span>

<span class="c1"># Configure model to return attention values</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">AutoModel</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="n">model_name</span><span class="p">,</span> <span class="n">output_attentions</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  
<span class="n">tokenizer</span> <span class="o">=</span> <span class="n">AutoTokenizer</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="n">model_name</span><span class="p">)</span>

<span class="c1"># Tokenize input text</span>
<span class="n">inputs</span> <span class="o">=</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">input_text</span><span class="p">,</span> <span class="n">return_tensors</span><span class="o">=</span><span class="s1">&#39;pt&#39;</span><span class="p">)</span>

<span class="c1"># Run model</span>
<span class="n">outputs</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>

<span class="c1"># Retrieve attention from model outputs</span>
<span class="n">attention</span> <span class="o">=</span> <span class="n">outputs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># Convert input ids to token strings</span>
<span class="n">tokens</span> <span class="o">=</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">convert_ids_to_tokens</span><span class="p">(</span><span class="n">inputs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">bertviz</span> <span class="kn">import</span> <span class="n">model_view</span><span class="p">,</span> <span class="n">head_view</span>

<span class="c1"># Display model view</span>
<span class="n">model_view</span><span class="p">(</span><span class="n">attention</span><span class="p">,</span> <span class="n">tokens</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Display head view</span>
<span class="n">head_view</span><span class="p">(</span><span class="n">attention</span><span class="p">,</span> <span class="n">tokens</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><a class="reference external" href="https://github.com/jessevig/bertviz">Link to BertViz</a>.</p>
</section>
<section id="beyond-keywords-building-a-semantic-recipe-search-engine">
<h2><span class="section-number">6.6.27. </span>Beyond Keywords: Building a Semantic Recipe Search Engine<a class="headerlink" href="#beyond-keywords-building-a-semantic-recipe-search-engine" title="Permalink to this heading">#</a></h2>
<p>Semantic search enables content discovery based on meaning rather than just keywords. This approach uses vector embeddings - numerical representations of text that capture semantic essence.</p>
<p>By converting text to vector embeddings, we can quantify semantic similarity between different pieces of content in a high-dimensional vector space. This allows for comparison and search based on underlying meaning, surpassing simple keyword matching.</p>
<p>Here‚Äôs a Python implementation of semantic search for recipe recommendations using sentence-transformers:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sentence_transformers</span> <span class="kn">import</span> <span class="n">SentenceTransformer</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics.pairwise</span> <span class="kn">import</span> <span class="n">cosine_similarity</span>

<span class="c1"># Step 1: Prepare our data</span>
<span class="n">recipes</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;Banana and Date Sweetened Oatmeal Cookies&quot;</span><span class="p">,</span>
    <span class="s2">&quot;No-Bake Berry Chia Seed Pudding&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Deep-Fried Oreo Sundae with Caramel Sauce&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Loaded Bacon Cheeseburger Pizza&quot;</span><span class="p">,</span>
<span class="p">]</span>

<span class="c1"># Step 2: Load a pre-trained model for creating embeddings</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">SentenceTransformer</span><span class="p">(</span><span class="s1">&#39;all-MiniLM-L6-v2&#39;</span><span class="p">)</span>

<span class="c1"># Step 3: Create embeddings for our recipe descriptions</span>
<span class="n">recipe_embeddings</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">recipes</span><span class="p">)</span>

<span class="c1"># Step 4: Function to find similar recipes </span>
<span class="k">def</span> <span class="nf">find_similar_recipes</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">top_k</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
    <span class="c1"># Create embedding for the query</span>
    <span class="n">query_embedding</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">encode</span><span class="p">([</span><span class="n">query</span><span class="p">])</span>
    
    <span class="c1"># Calculate similarity</span>
    <span class="n">similarities</span> <span class="o">=</span> <span class="n">cosine_similarity</span><span class="p">(</span><span class="n">query_embedding</span><span class="p">,</span> <span class="n">recipe_embeddings</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    
    <span class="c1"># Get top k similar recipes </span>
    <span class="n">top_indices</span> <span class="o">=</span> <span class="n">similarities</span><span class="o">.</span><span class="n">argsort</span><span class="p">()[</span><span class="o">-</span><span class="n">top_k</span><span class="p">:][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    
    <span class="k">return</span> <span class="p">[(</span><span class="n">recipes</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">similarities</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">top_indices</span><span class="p">]</span>

<span class="c1"># Step 5: Test our semantic search</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;healthy dessert without sugar&quot;</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">find_similar_recipes</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Query: </span><span class="si">{</span><span class="n">query</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Most similar recipes:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">recipe</span><span class="p">,</span> <span class="n">score</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- </span><span class="si">{</span><span class="n">recipe</span><span class="si">}</span><span class="s2"> (Similarity: </span><span class="si">{</span><span class="n">score</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="skillner-automating-skill-extraction-in-python">
<h2><span class="section-number">6.6.28. </span>SkillNER: Automating Skill Extraction in Python<a class="headerlink" href="#skillner-automating-skill-extraction-in-python" title="Permalink to this heading">#</a></h2>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>!pip install skillNer
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>!python -m spacy download en_core_web_lg
</pre></div>
</div>
</div>
</details>
</div>
<p>Extracting skills from job postings, resumes, or other unstructured text can be time-consuming if done manually. SkillNER automates this process, making it faster and more efficient.</p>
<p>This tool can be useful for:</p>
<ul class="simple">
<li><p>Recruiters to automate skill extraction for faster candidate screening.</p></li>
<li><p>Data scientists to extract structured data from unstructured job-related text.</p></li>
</ul>
<p>Here‚Äôs a quick example:</p>
<div class="cell tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">spacy</span>
<span class="kn">from</span> <span class="nn">spacy.matcher</span> <span class="kn">import</span> <span class="n">PhraseMatcher</span>
<span class="kn">from</span> <span class="nn">skillNer.general_params</span> <span class="kn">import</span> <span class="n">SKILL_DB</span>
<span class="kn">from</span> <span class="nn">skillNer.skill_extractor_class</span> <span class="kn">import</span> <span class="n">SkillExtractor</span>

<span class="c1"># Load the spaCy model</span>
<span class="n">nlp</span> <span class="o">=</span> <span class="n">spacy</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;en_core_web_lg&quot;</span><span class="p">)</span>

<span class="c1"># Initialize the SkillExtractor</span>
<span class="n">skill_extractor</span> <span class="o">=</span> <span class="n">SkillExtractor</span><span class="p">(</span><span class="n">nlp</span><span class="p">,</span> <span class="n">SKILL_DB</span><span class="p">,</span> <span class="n">PhraseMatcher</span><span class="p">)</span>

<span class="c1"># Sample job description</span>
<span class="n">job_description</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">You are a data scientist with strong expertise in Python. You have solid experience in </span>
<span class="s2">data analysis and visualization, and can manage end-to-end data science projects. </span>
<span class="s2">You quickly adapt to new tools and technologies, and are fluent in both English and SQL.</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="c1"># Extract skills from the job description</span>
<span class="n">annotations</span> <span class="o">=</span> <span class="n">skill_extractor</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">job_description</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">annotations</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">skill_extractor</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">annotations</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="nlpaug-enhancing-nlp-model-performance-with-data-augmentation">
<h2><span class="section-number">6.6.29. </span>nlpaug: Enhancing NLP Model Performance with Data Augmentation<a class="headerlink" href="#nlpaug-enhancing-nlp-model-performance-with-data-augmentation" title="Permalink to this heading">#</a></h2>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>!pip install nlpaug
</pre></div>
</div>
</div>
</details>
</div>
<p>Limited training data for natural language processing tasks often results in overfitting and poor generalization of models.</p>
<p>The nlpaug library offers diverse NLP data augmentation techniques, helping researchers expand datasets and create robust models.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">nlpaug.augmenter.char</span> <span class="k">as</span> <span class="nn">nac</span>
<span class="kn">import</span> <span class="nn">nlpaug.augmenter.word</span> <span class="k">as</span> <span class="nn">naw</span>
<span class="kn">import</span> <span class="nn">nlpaug.augmenter.sentence</span> <span class="k">as</span> <span class="nn">nas</span>
</pre></div>
</div>
</div>
</div>
<p>Substitute character by keyboard distance:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;The quick brown fox jumps over the lazy dog.&quot;</span>

<span class="n">aug</span> <span class="o">=</span> <span class="n">nac</span><span class="o">.</span><span class="n">KeyboardAug</span><span class="p">()</span>
<span class="n">augmented_text</span> <span class="o">=</span> <span class="n">aug</span><span class="o">.</span><span class="n">augment</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Original:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Augmented Text:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">augmented_text</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Insert character randomly:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">aug</span> <span class="o">=</span> <span class="n">nac</span><span class="o">.</span><span class="n">RandomCharAug</span><span class="p">(</span><span class="n">action</span><span class="o">=</span><span class="s2">&quot;insert&quot;</span><span class="p">)</span>
<span class="n">augmented_text</span> <span class="o">=</span> <span class="n">aug</span><span class="o">.</span><span class="n">augment</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Original:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Augmented Text:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">augmented_text</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Substitute word by spelling mistake words dictionary:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">aug</span> <span class="o">=</span> <span class="n">naw</span><span class="o">.</span><span class="n">SpellingAug</span><span class="p">()</span>
<span class="n">augmented_texts</span> <span class="o">=</span> <span class="n">aug</span><span class="o">.</span><span class="n">augment</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Original:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Augmented Texts:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">augmented_texts</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Insert word by contextual word embeddings (BERT, DistilBERT, RoBERTA or XLNet):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">aug</span> <span class="o">=</span> <span class="n">naw</span><span class="o">.</span><span class="n">ContextualWordEmbsAug</span><span class="p">(</span>
    <span class="n">model_path</span><span class="o">=</span><span class="s1">&#39;bert-base-uncased&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;substitute&quot;</span><span class="p">)</span>
<span class="n">augmented_text</span> <span class="o">=</span> <span class="n">aug</span><span class="o">.</span><span class="n">augment</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Original:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Augmented Text:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">augmented_text</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Substitute word by WordNet‚Äôs synonym:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">aug</span> <span class="o">=</span> <span class="n">naw</span><span class="o">.</span><span class="n">SynonymAug</span><span class="p">(</span><span class="n">aug_src</span><span class="o">=</span><span class="s1">&#39;wordnet&#39;</span><span class="p">)</span>
<span class="n">augmented_text</span> <span class="o">=</span> <span class="n">aug</span><span class="o">.</span><span class="n">augment</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Original:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Augmented Text:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">augmented_text</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Split word to two tokens randomly:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">aug</span> <span class="o">=</span> <span class="n">naw</span><span class="o">.</span><span class="n">SplitAug</span><span class="p">()</span>
<span class="n">augmented_text</span> <span class="o">=</span> <span class="n">aug</span><span class="o">.</span><span class="n">augment</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Original:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Augmented Text:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">augmented_text</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><a class="reference external" href="https://github.com/makcedward/nlpaug">Link to nlpaug</a>.</p>
</section>
<section id="gliner-the-lightweight-alternative-to-llms-for-custom-ner">
<h2><span class="section-number">6.6.30. </span>GLiNER: The Lightweight Alternative to LLMs for Custom NER<a class="headerlink" href="#gliner-the-lightweight-alternative-to-llms-for-custom-ner" title="Permalink to this heading">#</a></h2>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>!pip install gliner spacy
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>!python -m spacy download en_core_web_sm
</pre></div>
</div>
</div>
</details>
</div>
<p>Traditional NER models are limited to predefined entity types. For example, spaCy‚Äôs default English model is trained to recognize only the follwoing entity types:</p>
<ul class="simple">
<li><p>PERSON (e.g., ‚ÄúJohn Smith‚Äù)</p></li>
<li><p>ORG (e.g., ‚ÄúMicrosoft‚Äù)</p></li>
<li><p>GPE (e.g., ‚ÄúNew York‚Äù)</p></li>
<li><p>DATE (e.g., ‚ÄúJune 15th‚Äù)</p></li>
<li><p>MONEY (e.g., ‚Äú$500‚Äù)</p></li>
</ul>
<p>Example of a traditional approach with spaCy:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">spacy</span>

<span class="c1"># Load a pre-trained model with fixed entity types</span>
<span class="n">nlp</span> <span class="o">=</span> <span class="n">spacy</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;en_core_web_sm&quot;</span><span class="p">)</span>

<span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">Maria Rodriguez loves making sushi and pizza in her spare time. She practices yoga </span>
<span class="s2">and rock climbing on weekends in Boulder, Colorado. Her friend Tom enjoys baking </span>
<span class="s2">fresh croissants and often brings them when they go hiking together in the Rocky Mountains.</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="c1"># Can only detect pre-defined entity types</span>
<span class="n">doc</span> <span class="o">=</span> <span class="n">nlp</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
<span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">doc</span><span class="o">.</span><span class="n">ents</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ent</span><span class="o">.</span><span class="n">text</span><span class="si">}</span><span class="s2"> =&gt; </span><span class="si">{</span><span class="n">ent</span><span class="o">.</span><span class="n">label_</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Identifying and extracting other types of entities from text requires either training separate models for each entity type or using large language models, which results in high computational costs and resource requirements.</p>
<p>GLiNER allows you to extract any custom entity types from text using a lightweight model. You can specify the entity types you want to extract at inference time without retraining the model.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">gliner</span> <span class="kn">import</span> <span class="n">GLiNER</span>

<span class="c1"># Initialize the model</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">GLiNER</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="s2">&quot;urchade/gliner_medium-v2.1&quot;</span><span class="p">)</span>

<span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">Maria Rodriguez loves making sushi and pizza in her spare time. She practices yoga </span>
<span class="s2">and rock climbing on weekends in Boulder, Colorado. Her friend Tom enjoys baking </span>
<span class="s2">fresh croissants and often brings them when they go hiking together in the Rocky Mountains.</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="c1"># Define custom entity types</span>
<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Person&quot;</span><span class="p">,</span> <span class="s2">&quot;Food&quot;</span><span class="p">,</span> <span class="s2">&quot;Hobby&quot;</span><span class="p">,</span> <span class="s2">&quot;Location&quot;</span><span class="p">]</span>

<span class="c1"># Extract entities</span>
<span class="n">entities</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict_entities</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>

<span class="c1"># Print the extracted entities</span>
<span class="k">for</span> <span class="n">entity</span> <span class="ow">in</span> <span class="n">entities</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">entity</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> =&gt; </span><span class="si">{</span><span class="n">entity</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>This example shows how GLiNER can identify multiple custom entity types (persons, foods, hobbies, and locations) in a single pass without needing separate models or extensive training for each category.</p>
<p><a class="reference external" href="https://github.com/urchade/GLiNER">Link to GLiNER</a>.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Chapter5"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="machine_learning.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">6.5. </span>Machine Learning</p>
      </div>
    </a>
    <a class="right-next"
       href="time_series.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">6.7. </span>Time Series</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#textblob-processing-text-in-one-line-of-code">6.6.1. TextBlob: Processing Text in One Line of Code</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#convert-names-into-a-generalized-format">6.6.2. Convert Names into a Generalized Format</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sumy-summarize-text-in-one-line-of-code">6.6.3. sumy: Summarize Text in One Line of Code</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spacy-streamlit-create-a-web-app-to-visualize-your-text-in-3-lines-of-code">6.6.4. Spacy_streamlit: Create a Web App to Visualize Your Text in 3 Lines of Code</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#textacy-extract-a-contiguous-sequence-of-words">6.6.5. textacy: Extract a Contiguous Sequence of Words</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#num2words-convert-number-to-words">6.6.6. Num2Words: Convert Number to Words</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#numerizer-standardizing-numerical-data-in-text">6.6.7. Numerizer: Standardizing Numerical Data in Text</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#preprocess-text-in-one-line-of-code-with-texthero">6.6.8. Preprocess Text in One Line of Code with Texthero</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#texthero-reduce-dimension-and-visualize-text-in-one-line-of-code">6.6.9. texthero: Reduce Dimension and Visualize Text in One Line of Code</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#wordfreq-estimate-the-frequency-of-a-word-in-36-languages">6.6.10. wordfreq: Estimate the Frequency of a Word in 36 Languages</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#newspaper3k-extract-meaningful-information-from-an-articles-in-2-lines-of-code">6.6.11. newspaper3k: Extract Meaningful Information From an Articles in 2 Lines of Code</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#questgen-ai-question-generator-in-python">6.6.12. Questgen.ai: Question Generator in Python</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#word-ninja-slice-your-lumped-together-words">6.6.13. Word Ninja: Slice Your Lumped-Together Words</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#textstat-calculate-statistics-from-text">6.6.14. textstat: Calculate Statistics From Text</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rapidfuzz-rapid-string-matching-in-python">6.6.15. RapidFuzz: Rapid String Matching in Python</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#checklist-create-data-to-test-your-nlp-model">6.6.16. Checklist: Create Data to Test Your NLP Model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#top2vec-quick-topic-modeling-in-python">6.6.17. Top2Vec: Quick Topic Modeling in Python</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#expanding-english-contractions-in-text">6.6.18. Expanding English Contractions in Text</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#inflect-generate-plurals-singulars-and-indefinite-articles">6.6.19. inflect: Generate Plurals, Singulars, and Indefinite Articles</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ekphrasis-text-processing-tool-for-social-media-text">6.6.20. ekphrasis: Text Processing Tool For Social Media Text</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#chroma-the-lightning-fast-solution-to-text-embeddings-and-querying">6.6.21. Chroma: The Lightning-Fast Solution to Text Embeddings and Querying</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#galatic-clean-and-analyze-massive-text-datasets">6.6.22. Galatic: Clean and Analyze Massive Text Datasets</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#efficient-keyword-extraction-and-replacement-with-flashtext">6.6.23. Efficient Keyword Extraction and Replacement with FlashText</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bertopic-harnessing-bert-for-interpretable-topic-modeling">6.6.24. BERTopic: Harnessing BERT for Interpretable Topic Modeling</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#berttopic-enhance-topic-models-with-expert-defined-themes">6.6.25. BertTopic: Enhance Topic Models with Expert-Defined Themes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bertviz-visualize-nlp-model-attention-patterns">6.6.26. BertViz: Visualize NLP Model Attention Patterns</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#beyond-keywords-building-a-semantic-recipe-search-engine">6.6.27. Beyond Keywords: Building a Semantic Recipe Search Engine</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#skillner-automating-skill-extraction-in-python">6.6.28. SkillNER: Automating Skill Extraction in Python</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#nlpaug-enhancing-nlp-model-performance-with-data-augmentation">6.6.29. nlpaug: Enhancing NLP Model Performance with Data Augmentation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#gliner-the-lightweight-alternative-to-llms-for-custom-ner">6.6.30. GLiNER: The Lightweight Alternative to LLMs for Custom NER</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Khuyen Tran
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      ¬© Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=c5ced968eda925caa686"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=c5ced968eda925caa686"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>